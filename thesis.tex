\documentclass[fontsize=12pt,paper=letter,draft=true]{scrbook}

% for 1.5 line spacing
\usepackage{setspace}
\onehalfspacing
% single spacing for table of contents
\AfterTOCHead{\singlespacing}

% recompute page layout based on the above
\recalctypearea

% more colors (like RedOrange)
\usepackage[dvipsnames]{xcolor}

% brewer qualitative colors
\definecolor{brewergreen}{HTML}{1b9e77}
\definecolor{brewerorange}{HTML}{d95f02}
\definecolor{brewerpurple}{HTML}{7570b3}

% so we can splice in PDFs
\usepackage{pdfpages}

% set up bibliography
\usepackage[
  backend=bibtex,
  sortcites=true,
  sorting=anyt,
  abbreviate=false,
  style=numeric,
  citestyle=numeric,
  isbn=false,
  url=false,
  doi=false]{biblatex}
\addbibresource{bibliography.bib}

% enumerate* and itemize*
\usepackage[inline]{enumitem}

% for \begin{comment}
\usepackage{verbatim}

% for source-code listings
\usepackage[newfloat,draft=false]{minted}

% for formulas
\usepackage{mathtools}

% to split lists into multiple columns
\usepackage{multicol}

% for "on page NN" reference
\usepackage[nospace]{varioref}

% for \sfrac
\usepackage{xfrac}

% do not reset page numbers at \mainmatter
\let\mainmatterorig\mainmatter
\renewcommand\mainmatter
 {\edef\p{\arabic{page}}%
  \mainmatterorig
  % we need to compute the actual current page number. we know the page number
  % from _before_ we called \mainmatter. but what is it now? well, it is
  % certainly that +1. but we also need to account for the next chapter starting
  % on a "right" (odd) page. we do this by adding the page number modulo two.
  % TODO: double check before final version
  \setcounter{page}{\p+1+(\p-\p/2*2)}%
 }

% an environment for todos
\newenvironment{inprogress}
  {\vspace{.5em} \color{brewerorange} \noindent \textbf{TODO}}
  {\vspace{.5em}}

% a command to indicate current editing progress
\newcommand{\resume}{
  \begin{center}
    \color{brewerorange}
    \hrule
    \vspace{1pt}
    \hrule
    \hrule
    \vspace{10pt}
    \textbf{This section is not yet complete.}
    \vspace{10pt}
    \hrule
    \hrule
    \vspace{1pt}
    \hrule
  \end{center}
}

% an environment for invariants
\newcounter{invn}
\renewcommand{\theinvn}{\Roman{invn}}
\newenvironment{invariant}
  {\vspace{.5em} \color{brewerorange} \refstepcounter{invn} \noindent \textbf{\color{brewerorange} Invariant \Roman{invn}.}}
  {\vspace{.5em}}

% for handy reference
%
% paragraph without spacing:
% \setparsizes{0pt}{0pt}{0pt plus 1fil}

% additional hyphenation rules
\hyphenation{da-ta-flow}

% in thesis: titlehead, subject, title, subtitle
\title{Noria: Partial State in Dataflow}
\author{Jon Gjengset}
\begin{document}

\frontmatter

% always arabic page numbering (default is roman in \frontmatter)
\pagenumbering{arabic}

\includepdf[pages=-]{./titlepage.pdf}
\leavevmode\thispagestyle{empty}\newpage % since title page is single-sided

\includepdf[pages=-]{./abstract.pdf}
\leavevmode\thispagestyle{empty}\newpage % since abstract is also single-sided

\section*{Prior Publication}
Much of this thesis was previously published in a conference paper~\cite{noria},
and represents the joint work of the coauthors of that paper.
\newpage

\section*{Acknowledgements}
\begin{spacing}{1}
  % TODO
  Goes here.
\end{spacing}

\tableofcontents

\mainmatter

\chapter{Introduction}

\input{01-introduction.tex}

\chapter{Background \& Related Work}

\input{02-background.tex}

\chapter{Noria}
\label{s:noria}

\input{03-noria.tex}

\chapter{Partial State}

\input{04-partial-model.tex}

\chapter{Maintaining Correctness}
\label{s:correct}

\input{05-partial.tex}

\chapter{Evaluation}

\input{06-evaluation.tex}

\chapter{Discussion}

\input{07-discussion.tex}

\chapter{Future Work}

\input{08-future-work.tex}

\appendix
\chapter{Noria In Simpler Terms}

\input{A1-discussion.tex}

\backmatter

% single spacing for bibliography
\begin{spacing}{1}
\printbibliography
\end{spacing}

\end{document}
